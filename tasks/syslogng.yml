---

- name: Install Syslog-ng
  yum:
    name: syslog-ng
    state: present

- name: Populate service facts
  service_facts:

- name: Gather NGINX log files if needed
  find: 
    paths: /var/log/nginx/
    patterns: "*.log"
    recurse: yes
  register: nginx_sites
  when: "'nginx' in services"

- name: Configure Syslog-ng
  template:
    backup: yes
    src: syslog-ng.conf.j2
    dest: /etc/syslog-ng/syslog-ng.conf
    mode: 0644
    owner: root
    group: wheel
  notify: Enable syslog-ng
  tags: config
